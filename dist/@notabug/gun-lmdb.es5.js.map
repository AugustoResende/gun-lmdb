{"version":3,"file":"gun-lmdb.es5.js","sources":["../../src/client.ts","../../src/receiver.ts","../../src/gun.ts","../../src/@notabug/gun-lmdb.ts"],"sourcesContent":["import lmdb from 'node-lmdb'\n\nexport interface GunNode {\n  _: {\n    '#': string\n    '>': {\n      [key: string]: number\n    }\n    [key: string]: any\n  }\n  [key: string]: any\n}\n\nexport interface GunPut {\n  [soul: string]: GunNode\n}\n\nconst DEFAULT_CONFIG = {\n  path: 'lmdb'\n}\n\nexport class GunLmdbClient {\n  Gun: any\n  env: any\n  dbi: any\n\n  constructor(Gun: any, lmdbConfig = DEFAULT_CONFIG) {\n    this.Gun = Gun\n    this.env = new lmdb.Env()\n    this.env.open(lmdbConfig)\n    this.dbi = this.env.openDbi({\n      name: 'gun-nodes',\n      create: true\n    })\n  }\n\n  async get(soul: string) {\n    if (!soul) return null\n    const txn = this.env.beginTxn()\n    try {\n      const data = this.deserialize(txn.getStringUnsafe(this.dbi, soul))\n      txn.commit()\n      return data\n    } catch (e) {\n      txn.abort()\n      throw e\n    }\n  }\n\n  async getRaw(soul: string) {\n    if (!soul) return null\n    const txn = this.env.beginTxn()\n    try {\n      const data = txn.getString(this.dbi, soul)\n      txn.commit()\n      return data || ''\n    } catch (e) {\n      txn.abort()\n      throw e\n    }\n  }\n\n  async read(soul: string) {\n    const data = await this.get(soul)\n    if (!data) return\n\n    if (!this.Gun.SEA || soul.indexOf('~') === -1) return data\n\n    for (let key in data) {\n      if (key === '_') continue\n      this.Gun.SEA.verify(\n        this.Gun.SEA.opt.pack(data[key], key, data, soul),\n        false,\n        (res: GunNode) => (data[key] = this.Gun.SEA.opt.unpack(res, key, data))\n      )\n    }\n\n    return data\n  }\n\n  serialize(node: GunNode) {\n    return JSON.stringify(node)\n  }\n\n  deserialize(data: string) {\n    return JSON.parse(data)\n  }\n\n  async writeNode(soul: string, nodeData: GunNode) {\n    if (!soul) return\n    const txn = this.env.beginTxn()\n    const nodeDataMeta = (nodeData && nodeData['_']) || {}\n    const nodeDataState = nodeDataMeta['>'] || {}\n\n    try {\n      const existingData = txn.getStringUnsafe(this.dbi, soul)\n      const node = this.deserialize(existingData) || {}\n      const meta = (node['_'] = node['_'] || { '#': soul, '>': {} })\n      const state = (meta['>'] = meta['>'] || {})\n\n      for (let key in nodeData) {\n        if (key === '_' || !(key in nodeDataState)) continue\n        node[key] = nodeData[key]\n        state[key] = nodeDataState[key]\n      }\n\n      txn.putString(this.dbi, soul, this.serialize(node))\n      txn.commit()\n    } catch (e) {\n      txn.abort()\n      throw e\n    }\n  }\n\n  async write(put: GunPut) {\n    if (!put) return\n    for (let soul in put) await this.writeNode(soul, put[soul])\n  }\n\n  close() {\n    this.dbi.close()\n    this.env.close()\n  }\n}\n\nexport function createClient(Gun: any, options: any) {\n  return new GunLmdbClient(Gun, options)\n}\n","import { GunLmdbClient, GunNode } from './client'\n\nexport const respondToGets = (\n  Gun: any,\n  { disableRelay = true, skipValidation = true } = {},\n  lmdbOpts = undefined\n) => (db: any) => {\n  const lmdb = (Gun.lmdb = db.lmdb = new GunLmdbClient(Gun, lmdbOpts))\n\n  db.onIn(async function gunLmdbRespondToGets(msg: any) {\n    const { from, json, fromCluster } = msg\n    const get = json && json.get\n    const soul = get && get['#']\n    const dedupId = (json && json['#']) || ''\n\n    if (!soul || fromCluster) return msg\n\n    try {\n      // const result = await lmdb.get(soul)\n      const rawResult = await lmdb.getRaw(soul)\n      let put = 'null'\n      if (rawResult) {\n        put = ['{', `${JSON.stringify(soul)}: ${rawResult}`, '}'].join('')\n      }\n      const raw: string = [\n        '{',\n        `\"#\": ${JSON.stringify(from.msgId())},`,\n        `\"@\": ${JSON.stringify(dedupId)},`,\n        `\"put\": ${put}`,\n        '}'\n      ].join('')\n      /*\n      const json = {\n        '#': from.msgId(),\n        '@': dedupId,\n        put: result ? { [soul]: result } : null\n      }\n      */\n\n      from.send({\n        raw,\n        // json,\n        ignoreLeeching: true,\n        skipValidation: !rawResult || skipValidation\n      })\n\n      return disableRelay && rawResult ? { ...msg, noRelay: true } : msg\n    } catch (err) {\n      console.error('get err', err.stack || err)\n      const json = {\n        '#': from.msgId(),\n        '@': dedupId,\n        err: `${err}`\n      }\n\n      from.send({ json, ignoreLeeching: true, skipValidation })\n      return msg\n    }\n  })\n\n  return db\n}\n\nexport const acceptWrites = (Gun: any, { disableRelay = false } = {}, lmdbOpts = undefined) => (\n  db: any\n) => {\n  const lmdb = (Gun.lmdb = db.lmdb = new GunLmdbClient(Gun, lmdbOpts))\n\n  db.onIn(async function gunLmdbAcceptWrites(msg: any) {\n    if (msg.fromCluster || !msg.json.put) return msg\n    const diff: GunNode = await db.getDiff(msg.json.put)\n    const souls = diff && Object.keys(diff)\n\n    if (!souls || !souls.length) {\n      return disableRelay ? { ...msg, noRelay: true } : msg\n    }\n\n    try {\n      await lmdb.write(diff)\n      const json = { '@': msg.json['#'], ok: true, err: null }\n\n      msg.from &&\n        msg.from.send &&\n        msg.from.send({\n          json,\n          noRelay: true,\n          ignoreLeeching: true,\n          skipValidation: true\n        })\n      return msg\n    } catch (err) {\n      console.error('error writing data', err)\n      const json = { '@': msg.json['#'], ok: false, err: `${err}` }\n\n      msg.from &&\n        msg.from.send &&\n        msg.from.send({\n          json,\n          noRelay: disableRelay,\n          ignoreLeeching: true,\n          skipValidation: true\n        })\n\n      return msg\n    }\n  })\n\n  return db\n}\n","import { GunLmdbClient, GunPut } from './client'\n\ninterface GunGet {\n  '#': string\n  get: {\n    '#': string\n  }\n}\n\nexport const attachToGun = (Gun: any, options?: any) =>\n  Gun.on('create', function(this: any, db: any) {\n    const lmdb = (Gun.lmdb = db.lmdb = new GunLmdbClient(Gun, options))\n\n    db.on('get', async function(this: any, request: GunGet) {\n      this.to.next(request)\n      if (!request) return\n      const dedupId = request['#']\n      const get = request.get\n      const soul = get['#']\n\n      try {\n        const result = await lmdb.get(soul)\n        db.on('in', {\n          '@': dedupId,\n          put: result ? { [soul]: result } : null,\n          err: null\n        })\n      } catch (err) {\n        console.error('error', err.stack || err)\n        db.on('in', {\n          '@': dedupId,\n          put: null,\n          err\n        })\n      }\n    })\n\n    db.on('put', async function(this: any, request: GunPut) {\n      if (!request) return this.to.next(request)\n      const dedupId = request['#']\n\n      try {\n        await lmdb.write(request.put)\n        db.on('in', {\n          '@': dedupId,\n          ok: true,\n          err: null\n        })\n      } catch (err) {\n        db.on('in', {\n          '@': dedupId,\n          ok: false,\n          err: err\n        })\n      }\n\n      this.to.next(request)\n    })\n\n    this.to.next(db)\n  })\n","import * as receiverFns from '../receiver'\nexport { attachToGun } from '../gun'\nexport { createClient } from \"../client\";\n\nexport const receiver = receiverFns\n"],"names":["lmdb"],"mappings":"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"}